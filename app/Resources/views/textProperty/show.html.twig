{% extends 'base.html.twig' %}
{% block body %}
    <div class="container">
        <div class="row">
            <div class="col-xs-12">
                <h2>

                    {% if textProperty.class is not null %}
                        {% set route = 'class_show' %}
                        {{ textProperty.systemType.standardLabel|capitalize }} for the class {{ textProperty.class.classVersionForDisplay(textProperty.namespaceForVersion) }}
                    {% elseif textProperty.property is not null %}
                        {% set route = 'property_show' %}
                        {{ textProperty.systemType.standardLabel|capitalize }} for the property {{ textProperty.property.propertyVersionForDisplay(textProperty.namespaceForVersion) }}
                    {% elseif textProperty.namespace is not null %}
                        {% set route = 'namespace_show' %}
                        {% if textProperty.object is not null %}
                            {% if textProperty.object.identifierInNamespace is not null %}
                                {{ textProperty.object.standardLabel }} – {{ textProperty.object.identifierInNamespace }}: {{ textProperty.systemType.standardLabel }}
                            {% else %}
                                {{ textProperty.object.objectIdentification }}: {{ textProperty.systemType.standardLabel }}
                            {% endif %}
                        {% else %}
                            {{ textProperty.systemType.standardLabel }}
                        {% endif %}
                    {% elseif textProperty.project is not null %}
                        {% set route = 'project_show' %}
                        {% if textProperty.object is not null %}
                            {% if textProperty.object.identifierInNamespace is not null %}
                                {{ textProperty.object.standardLabel }} – {{ textProperty.object.identifierInNamespace }}: {{ textProperty.systemType.standardLabel }}
                            {% else %}
                                {{ textProperty.object.objectIdentification }}: {{ textProperty.systemType.standardLabel }}
                            {% endif %}
                        {% else %}
                            {{ textProperty.systemType.standardLabel }}
                        {% endif %}
                    {% elseif textProperty.profile is not null %}
                        {% set route = 'profile_show' %}
                        {% if textProperty.object is not null %}
                            {% if textProperty.object.identifierInNamespace is not null %}
                                {{ textProperty.object.standardLabel }} – {{ textProperty.object.identifierInNamespace }}: {{ textProperty.systemType.standardLabel }}
                            {% else %}
                                {{ textProperty.object.objectIdentification }}: {{ textProperty.systemType.standardLabel }}
                            {% endif %}
                        {% else %}
                            {{ textProperty.systemType.standardLabel }}
                        {% endif %}
                    {% elseif textProperty.classAssociation is not null %}
                        {% set route = 'class_association_show' %}
                        {% if textProperty.object is not null %}
                            {% if textProperty.object.identifierInNamespace is not null %}
                                {{ textProperty.object.standardLabel }} – {{ textProperty.object.identifierInNamespace }}: {{ textProperty.systemType.standardLabel }}
                            {% else %}
                                {{ textProperty.object.objectIdentification }}: {{ textProperty.systemType.standardLabel }}
                            {% endif %}
                        {% else %}
                            {{ textProperty.systemType.standardLabel }}
                        {% endif %}
                    {% elseif textProperty.propertyAssociation is not null %}
                        {% set route = 'property_association_show' %}
                    {% elseif textProperty.entityAssociation is not null %}
                        {% set route = 'entity_association_show' %}
                        {% if textProperty.entityAssociation.sourceClass is not null %}
                            {{ textProperty.entityAssociation.sourceClass }} {{ textProperty.entityAssociation.systemType.standardLabel }} {{ textProperty.entityAssociation.targetClass }} : {{ textProperty.systemType.standardLabel }}
                        {% elseif textProperty.entityAssociation.sourceProperty is not null %}
                            {{ textProperty.entityAssociation.sourceClass }} {{ textProperty.entityAssociation.systemType.standardLabel }} {{ textProperty.entityAssociation.targetClass }} : {{ textProperty.systemType.standardLabel }}
                        {% endif %}
                    {% endif %}

                    {% if route is not null %}
                    <a href="{{ path(route, {'id':textProperty.object.id, '_fragment': 'definition'}) }}"
                       class="pull-right btn btn-link"
                       role="button">
                        <i class="fas fa-arrow-left"></i><span>&nbsp;Back</span>
                    </a>
                    {% else %}
                    <a href="{{ app.request.headers.get('referer') }}#definition"
                       class="pull-right btn btn-link"
                       role="button">
                        <i class="fas fa-arrow-left"></i><span>&nbsp;Back</span>
                    </a>
                    {% endif %}
                </h2>
                <ul class="nav nav-tabs" id="main-tabs">
                    <li class="active"><a data-toggle="tab" href="#text-property">{{ textProperty.systemType }}</a></li>
                    <li><a data-toggle="tab" href="#comments">Comments</a></li>
                </ul>
                <div class="tab-content">
                    <div id="text-property" class="tab-pane fade in active">
                        <div class="container">
                            <h3>{{ textProperty.systemType }}</h3>
                            <dl class="object-details-list">
                                <dt>Text</dt>
                                <dd class="well">{{ textProperty.textProperty|raw}}</dd>
                                <dt>Language</dt>
                                <dd>{{ textProperty.languageIsoCode}}</dd>
                            </dl>
                        </div>
                    </div>
                    <div id="comments" class="tab-pane fade">
                        <h3>Comments</h3>
                        <div class="comment-box js-user-info" data-fullname="{{ app.user }}">
                            <div class="action-box">
                                {% if textProperty.comments is empty %}
                                    <p id="comment-not-found"><em>No comment found.</em></p>
                                {% endif %}
                                <ul id="comments-list" class="comments-list">
                                    {% for comment in textProperty.comments %}
                                        <li>
                                            <div class="comment-text">
                                                <p><strong><a href="#">{{ comment.creator.fullName }}</a></strong></p>
                                                <p>{{ comment.comment }}</p>
                                                <span class="date sub-comment-text">on {{ comment.creationTime|date() }}</span>
                                            </div>
                                        </li>
                                    {% endfor %}
                                </ul>

                                {% if app.user %}
                                    <div class="new-comment-form" id="new-comment-form">
                                        {{ render(controller('AppBundle:Comment:new', {'object' : 'text-property', 'objectId' : textProperty.id})) }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block javascripts %}
    {{ parent() }}
    {% include 'comment/js-bock.html.twig'  with {'objectType': 'text-property', 'objectId' : textProperty.id  } %}
{% endblock %}
